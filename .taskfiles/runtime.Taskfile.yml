# yaml-language-server: $schema=https://taskfile.dev/schema.json
# docs: https://taskfile.dev
---
version: "3"

tasks:
  setup:uv:
    desc: uv setup
    cmds:
      - cmd: |
          ./.taskfiles/scripts/setup_uv.sh "{{.VERSION.uv}}"
        platforms: [linux]
      - task: :internal:_install:brew
        vars:
          APP: uv@{{.VERSION.uv}}
      - task: :internal:_install:winget
        vars:
          APP: astral-sh.uv
          VERSION: "{{.VERSION.uv}}"

  setup:fnm:
    desc: fnm setup
    cmds:
      - cmd: |
          ./.taskfiles/scripts/setup_fnm.sh "{{.VERSION.fnm}}"
        platforms: [linux]
      - task: :internal:_install:brew
        vars:
          APP: fnm@{{.VERSION.fnm}}
      - task: :internal:_install:winget
        vars:
          APP: Schniz.fnm
          VERSION: "{{.VERSION.fnm}}"

  setup:pwsh:
    desc: pwsh setup
    cmds:
      - cmd: |
          sudo ./.taskfiles/scripts/setup_pwsh.sh "{{.VERSION.pwsh}}"
        platforms: [linux]
      # TODO:
      # - task: :internal:_install:brew
      #   vars:
      #     APP: "powershell@{{.VERSION.pwsh}}"
      - task: :internal:_install:winget
        vars:
          APP: Microsoft.PowerShell
          VERSION: "{{.VERSION.pwsh}}"

  setup:golang:
    desc: golang setup
    cmds:
      - cmd: |
          ./.taskfiles/scripts/setup_golang.sh "{{.VERSION.golang}}"
        platforms: [linux]
      - task: :internal:_install:brew
        vars:
          APP: golang@{{.VERSION.golang}}
      - task: :internal:_install:winget
        vars:
          APP: GoLang.Go
          VERSION: "{{.VERSION.golang}}"

  # * Setup
  setup:
    desc: Setup Runtime environments
    vars:
      ITEMS:
        - golang
        - uv
        - fnm
        - pwsh
    cmds:
      - for: { var: ITEMS }
        task: setup:{{.ITEM}}
